from flask import Flask, request
import requests

app = Flask(__name__)

# --- –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ô –¢–û–ö–ï–ù –ò CHAT_ID ---
TELEGRAM_TOKEN = '–í–ê–®_–¢–û–ö–ï–ù_–û–¢_BOTFATHER'
CHAT_ID = '–í–ê–®_CHAT_ID'
TELEGRAM_API_URL = f"https://api.telegram.org/bot{TELEGRAM_TOKEN}/sendMessage"

@app.route('/webhook', methods=['POST'])
def webhook():
    data = request.json

    symbol = data.get('symbol', '???')
    action = data.get('action', '???')
    message = data.get('message', '–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞')

    final_message = f"üìà <b>–°–∏–≥–Ω–∞–ª —Å TradingView</b>:\n\n" \
                    f"üíπ <b>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:</b> {symbol}\n" \
                    f"üìç <b>–î–µ–π—Å—Ç–≤–∏–µ:</b> {action}\n\n" \
                    f"üì© <b>–°–æ–æ–±—â–µ–Ω–∏–µ:</b> {message}"

    send_to_telegram(final_message)
    return 'OK', 200

def send_to_telegram(text):
    payload = {
        'chat_id': CHAT_ID,
        'text': text,
        'parse_mode': 'HTML'
    }
    requests.post(TELEGRAM_API_URL, data=payload)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
